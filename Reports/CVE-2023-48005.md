### Pictshare upload via URL is vulnerable to SSRF causing file disclosure and information leak

- **Application**: Pictshare <= commit 5c3ee9e
- **Threat Impact**: Sensitive data leakage, file disclosure
- **Code**: Parameter `url` is retrieved from the request and spaces are trimmed. Then it is directly used by the sink function `file_get_contents`

  File: `api/geturl.php`

  ```
  $url = trim($_REQUEST['url']);
  file_put_contents($tmpfile,file_get_contents($url));
  ```

- **POC**:
  1. Listen on 8080 on server side
  1. Send a get request to /api/geturl.php, with parameter `url=http://localhost:8080`
  1. Receive a request on server side. The full response is also disclosed in file
