### blocksy-companion

- **Application**: blocksy-companion <= 2.0.42

- **Threat Impact**: Sensitive data leakage

- **Code**: 

  ```
  public function maybe_save_credentials($save = true) {
    $m=Provider::get_for_provider($provider);
    $m->fetch_lists($_POST['api_key']);
    
    public function fetch_lists($api_key) {
      $response = wp_remote_get(
  			'https://' . $api_key . '.api.mailchimp.com/3.0/lists?count=1000');
    }
  }
  ```

- **POC**:

  1. Listen on 8888 on server side
  1. When specify mailchimp api, use `ssrf.localdomain.pw/custom%2D30x/?code=302&url=http://127.0.0.1:8888?` for api key.
  1. Receive a request on server side. 



